<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>HR Vault â€” Reference Architecture</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: #0d1117;
    color: #e2e8f0;
    font-family: 'Segoe UI', system-ui, sans-serif;
    padding: 32px 24px;
    min-height: 100vh;
  }
  h1 { font-size: 1.4rem; font-weight: 700; margin-bottom: 4px; }
  .subtitle { color: #64748b; font-size: 0.85rem; margin-bottom: 32px; }

  /* â”€â”€ Legend â”€â”€ */
  .legend {
    display: flex;
    gap: 20px;
    margin-bottom: 28px;
    flex-wrap: wrap;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.8rem;
    color: #94a3b8;
  }
  .dot {
    width: 12px; height: 12px;
    border-radius: 3px;
    flex-shrink: 0;
  }
  .dot-done    { background: #22c55e; }
  .dot-partial { background: #f59e0b; }
  .dot-todo    { background: #334155; border: 1px solid #475569; }

  /* â”€â”€ Architecture flow â”€â”€ */
  .arch {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
    max-width: 680px;
    margin: 0 auto 48px;
  }

  .layer {
    width: 100%;
    border-radius: 12px;
    padding: 16px 20px;
    position: relative;
  }
  .layer-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 6px;
  }
  .layer-title {
    font-weight: 700;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .layer-desc {
    font-size: 0.78rem;
    color: #94a3b8;
    line-height: 1.5;
  }
  .badge {
    font-size: 0.68rem;
    font-weight: 700;
    padding: 3px 10px;
    border-radius: 999px;
    white-space: nowrap;
    flex-shrink: 0;
  }
  .badge-done    { background: #14532d; color: #86efac; }
  .badge-partial { background: #451a03; color: #fcd34d; }
  .badge-todo    { background: #1e293b; color: #64748b; }

  /* Layer colours */
  .l-user     { background: #1a1d27; border: 1px solid #2a2d3a; }
  .l-dns      { background: #1a1d27; border: 1px dashed #334155; }
  .l-waf      { background: #1c1a2e; border: 1px solid #3730a3; }
  .l-auth0    { background: #1a1f2e; border: 1px solid #1d4ed8; }
  .l-nginx    { background: #1a2420; border: 1px solid #166534; }
  .l-fastapi  { background: #1a2420; border: 1px solid #166534; }
  .l-ct       { background: #1f1a2e; border: 1px solid #6d28d9; }
  .l-db       { background: #1a1d27; border: 1px solid #2a2d3a; }

  /* Arrow */
  .arrow {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    padding: 4px 0;
  }
  .arrow-line {
    width: 2px;
    height: 18px;
    background: #334155;
  }
  .arrow-head {
    width: 0; height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 8px solid #334155;
  }
  .arrow-label {
    font-size: 0.68rem;
    color: #475569;
    margin-top: 2px;
  }

  /* â”€â”€ Status table â”€â”€ */
  .status-section { max-width: 680px; margin: 0 auto; }
  .status-section h2 {
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 16px;
    color: #94a3b8;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.82rem;
  }
  th {
    text-align: left;
    padding: 8px 12px;
    color: #64748b;
    border-bottom: 1px solid #1e293b;
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.04em;
  }
  td {
    padding: 10px 12px;
    border-bottom: 1px solid #1e293b;
    vertical-align: top;
  }
  tr:last-child td { border-bottom: none; }
  .status-done    { color: #22c55e; font-weight: 600; }
  .status-partial { color: #f59e0b; font-weight: 600; }
  .status-todo    { color: #475569; }
  .phase-tag {
    display: inline-block;
    font-size: 0.68rem;
    padding: 2px 8px;
    border-radius: 4px;
    background: #1e293b;
    color: #64748b;
  }
</style>
</head>
<body>

<h1>ğŸ” HR Vault â€” Reference Architecture</h1>
<p class="subtitle">techsodoki.com Â· End-state security architecture</p>

<!-- Legend -->
<div class="legend">
  <div class="legend-item"><div class="dot dot-done"></div> Deployed & working</div>
  <div class="legend-item"><div class="dot dot-partial"></div> In progress</div>
  <div class="legend-item"><div class="dot dot-todo"></div> Not yet built</div>
</div>

<!-- Architecture diagram -->
<div class="arch">

  <!-- User -->
  <div class="layer l-user">
    <div class="layer-header">
      <div class="layer-title">ğŸŒ End User Browser</div>
      <span class="badge badge-done">DONE</span>
    </div>
    <div class="layer-desc">HTML / CSS / Vanilla JS Â· Safari, Chrome, etc.</div>
  </div>

  <div class="arrow">
    <div class="arrow-line"></div>
    <div class="arrow-head"></div>
    <div class="arrow-label">HTTPS Â· techsodoki.com</div>
  </div>

  <!-- Cloudflare -->
  <div class="layer l-dns">
    <div class="layer-header">
      <div class="layer-title">â˜ï¸ Cloudflare DNS</div>
      <span class="badge badge-todo">NOT BUILT</span>
    </div>
    <div class="layer-desc">DNS resolution for techsodoki.com Â· Routes traffic to Imperva Â· Free SSL/TLS</div>
  </div>

  <div class="arrow">
    <div class="arrow-line"></div>
    <div class="arrow-head"></div>
    <div class="arrow-label">DNS â†’ Imperva IP</div>
  </div>

  <!-- Imperva WAF -->
  <div class="layer l-waf">
    <div class="layer-header">
      <div class="layer-title">ğŸ›¡ï¸ Imperva Cloud WAF</div>
      <span class="badge badge-todo">NOT BUILT</span>
    </div>
    <div class="layer-desc">Blocks SQLi, XSS, CSRF, bad bots Â· Rate limiting Â· Geo rules Â· DDoS protection Â· Forwards clean traffic to origin server</div>
  </div>

  <div class="arrow">
    <div class="arrow-line"></div>
    <div class="arrow-head"></div>
    <div class="arrow-label">Clean traffic only</div>
  </div>

  <!-- Auth0 sits beside the main flow -->
  <div style="width:100%; display:flex; gap:12px; align-items:stretch;">
    <div style="flex:1;">
      <!-- NGINX -->
      <div class="layer l-nginx" style="margin-bottom:0; height:100%;">
        <div class="layer-header">
          <div class="layer-title">âš¡ NGINX Reverse Proxy</div>
          <span class="badge badge-done">DONE</span>
        </div>
        <div class="layer-desc">Serves static frontend files Â· Proxies /api/ to FastAPI Â· Mirrors Imperva routing pattern locally</div>
      </div>
    </div>
    <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px; padding: 0 4px;">
      <div style="width:40px; height:2px; background:#1d4ed8;"></div>
      <div style="font-size:0.65rem; color:#1d4ed8; white-space:nowrap;">JWT verify</div>
      <div style="width:40px; height:2px; background:#1d4ed8;"></div>
    </div>
    <div style="flex:1;">
      <!-- Auth0 -->
      <div class="layer l-auth0" style="height:100%;">
        <div class="layer-header">
          <div class="layer-title">ğŸ”‘ Auth0</div>
          <span class="badge badge-done">DONE</span>
        </div>
        <div class="layer-desc">OIDC login Â· Issues JWT with role claim Â· Step-Up MFA for salary/NatID (Phase 4)</div>
      </div>
    </div>
  </div>

  <div class="arrow">
    <div class="arrow-line"></div>
    <div class="arrow-head"></div>
    <div class="arrow-label">Authenticated requests</div>
  </div>

  <!-- FastAPI -->
  <div class="layer l-fastapi">
    <div class="layer-header">
      <div class="layer-title">ğŸ FastAPI Backend</div>
      <span class="badge badge-partial">IN PROGRESS</span>
    </div>
    <div class="layer-desc">JWT validation âœ… Â· RBAC role enforcement (Phase 3) Â· Step-Up MFA acr check (Phase 4) Â· Business logic</div>
  </div>

  <div class="arrow">
    <div class="arrow-line"></div>
    <div class="arrow-head"></div>
    <div class="arrow-label">Role-checked queries</div>
  </div>

  <!-- CipherTrust -->
  <div style="width:100%; display:flex; gap:12px; align-items:stretch;">
    <div style="flex:1;">
      <div class="layer l-ct" style="height:100%;">
        <div class="layer-header">
          <div class="layer-title">ğŸ” CipherTrust DPG</div>
          <span class="badge badge-todo">NOT BUILT</span>
        </div>
        <div class="layer-desc">Data Protection Gateway Â· Sits between FastAPI and DB Â· Decrypts fields based on caller identity + policy Â· Masks salary, national ID</div>
      </div>
    </div>
    <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px; padding: 0 4px;">
      <div style="width:40px; height:2px; background:#6d28d9;"></div>
      <div style="font-size:0.65rem; color:#6d28d9; white-space:nowrap;">Key mgmt</div>
      <div style="width:40px; height:2px; background:#6d28d9;"></div>
    </div>
    <div style="flex:1;">
      <div class="layer l-ct" style="height:100%;">
        <div class="layer-header">
          <div class="layer-title">ğŸ—ï¸ CipherTrust Manager</div>
          <span class="badge badge-todo">NOT BUILT</span>
        </div>
        <div class="layer-desc">Docker container Â· AES-256 key management Â· Protection policies Â· Audit logs of all data access</div>
      </div>
    </div>
  </div>

  <div class="arrow">
    <div class="arrow-line"></div>
    <div class="arrow-head"></div>
    <div class="arrow-label">Encrypted at rest</div>
  </div>

  <!-- DB -->
  <div class="layer l-db">
    <div class="layer-header">
      <div class="layer-title">ğŸ—„ï¸ SQLite Database</div>
      <span class="badge badge-done">DONE</span>
    </div>
    <div class="layer-desc">Salary + National ID stored as AES-256 encrypted blobs (Phase 5) Â· Currently plaintext</div>
  </div>

</div>

<!-- OpenClaw Agent -->
<div style="max-width:680px; margin: 0 auto 48px; border: 1px dashed #334155; border-radius: 12px; padding: 20px;">
  <div style="font-size:0.72rem; color:#475569; text-transform:uppercase; letter-spacing:0.06em; margin-bottom:12px;">Phase 9 â€” AI Agent Layer</div>
  <div style="display:flex; gap:12px; align-items:stretch;">
    <div style="flex:1; background:#1a1f1a; border:1px solid #166534; border-radius:10px; padding:14px;">
      <div style="font-weight:700; font-size:0.88rem; margin-bottom:6px;">ğŸ¦ OpenClaw Agent</div>
      <div style="font-size:0.75rem; color:#94a3b8; line-height:1.5;">Runs on your machine Â· Reachable via WhatsApp / Telegram Â· Custom HR Vault skill Â· Natural language queries â†’ API calls</div>
    </div>
    <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px; padding: 0 4px;">
      <div style="width:40px; height:2px; background:#1d4ed8;"></div>
      <div style="font-size:0.65rem; color:#1d4ed8; white-space:nowrap;">M2M JWT</div>
      <div style="width:40px; height:2px; background:#1d4ed8;"></div>
    </div>
    <div style="flex:1; background:#1a1f2e; border:1px solid #1d4ed8; border-radius:10px; padding:14px;">
      <div style="font-weight:700; font-size:0.88rem; margin-bottom:6px;">ğŸ”‘ Auth0 M2M App</div>
      <div style="font-size:0.75rem; color:#94a3b8; line-height:1.5;">Dedicated agent identity Â· Role: ai_agent Â· Scoped permissions Â· Same JWT validation as human users</div>
    </div>
  </div>
  <div style="display:flex; justify-content:center; margin-top:8px;">
    <div style="font-size:0.72rem; color:#475569;">â†“ calls HR Vault FastAPI with M2M token Â· CipherTrust enforces ai_agent data policy</div>
  </div>
</div>

<!-- Status table -->
<div class="status-section">
  <h2>Build Status by Phase</h2>
  <table>
    <thead>
      <tr>
        <th>Phase</th>
        <th>What it adds</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="phase-tag">Phase 1</span></td>
        <td>FastAPI + SQLite + Docker Compose + NGINX + Frontend</td>
        <td class="status-done">âœ… Complete</td>
      </tr>
      <tr>
        <td><span class="phase-tag">Phase 2</span></td>
        <td>Auth0 login + JWT validation + role claims</td>
        <td class="status-done">âœ… Complete</td>
      </tr>
      <tr>
        <td><span class="phase-tag">Phase 3</span></td>
        <td>RBAC â€” role-based field filtering in FastAPI</td>
        <td class="status-partial">ğŸ”„ Next up</td>
      </tr>
      <tr>
        <td><span class="phase-tag">Phase 4</span></td>
        <td>Auth0 Step-Up MFA for salary + national ID</td>
        <td class="status-todo">â¬œ Not started</td>
      </tr>
      <tr>
        <td><span class="phase-tag">Phase 5</span></td>
        <td>CipherTrust Manager deployed (Docker) + AES-256 encryption</td>
        <td class="status-todo">â¬œ Not started</td>
      </tr>
      <tr>
        <td><span class="phase-tag">Phase 6</span></td>
        <td>CipherTrust DPG as data proxy between FastAPI and DB</td>
        <td class="status-todo">â¬œ Not started</td>
      </tr>
      <tr>
        <td><span class="phase-tag">Phase 7</span></td>
        <td>Deploy to cloud VM Â· Cloudflare DNS Â· Imperva WAF live</td>
        <td class="status-todo">â¬œ Not started</td>
      </tr>
      <tr>
        <td><span class="phase-tag">Phase 8</span></td>
        <td>README polish Â· GitHub release Â· Architecture docs final</td>
        <td class="status-todo">â¬œ Not started</td>
      </tr>
      <tr>
        <td><span class="phase-tag">Phase 9</span></td>
        <td>OpenClaw AI Agent Â· Custom HR Vault skill Â· Auth0 M2M token for agent identity Â· CipherTrust policy for ai_agent role Â· Query employees via WhatsApp/Telegram</td>
        <td class="status-todo">â¬œ Not started</td>
      </tr>
    </tbody>
  </table>
</div>

</body>
</html>
